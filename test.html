<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <style>
        body {
            text-align: center;
        }
    </style>
</head>

<body>
    <!-- Gauge -->
    <svg width="47.555mm" height="47.555mm" version="1.1" viewBox="0 0 47.555 47.555"
        xmlns="http://www.w3.org/2000/svg">
        <circle cx="23.778" cy="23.778" r="1.3229" fill="#f00" fill-opacity=".98565" stroke="#f00"
            stroke-width="1.852" />
        <g fill="none">
            <g stroke="#000">
                <circle cx="23.778" cy="23.778" r="22.852" stroke-width="1.852" />
                <circle cx="23.778" cy="23.778" r="18.521" />
                <g stroke-width=".26458px">
                    <path d="m5.2567 23.778h3.9688" />
                    <path d="m23.778 5.2567v3.9688" />
                    <path d="m10.548 10.548 2.6458 2.6458" />
                    <path d="m37.007 10.548-2.6458 2.6458" />
                    <path d="m42.298 23.778h-3.9688" />
                    <path d="m10.548 37.007 2.6458-2.6458" />
                    <path d="m37.007 37.007-2.6458-2.6458" />
                </g>
            </g>
            <path id="pointer" d="m26.423 21.132-11.906 11.906" stroke="#fe0000" stroke-width=".265" />
        </g>
        <rect x="18.486" y="33.038" width="10.583" height="5.2917" fill="#fff" stroke="#000" stroke-width=".265" />
        <text x="23.756287" y="37.020153" fill="#000000" font-family="sans-serif" font-size="10.583px"
            letter-spacing="0px" stroke-width=".26458" text-align="center" text-anchor="middle" word-spacing="0px"
            style="line-height:1.25" xml:space="preserve">
            <tspan id="label" font-size="3.5278px" label="">0%</tspan>
        </text>
    </svg>

    <!-- Bar Chart -->
    <svg id="main" width="210mm" height="297mm" version="1.1" viewBox="0 0 210 297" xmlns="http://www.w3.org/2000/svg"
        xmlns:xlink="http://www.w3.org/1999/xlink">
        <defs>
            <symbol id="symbol9718">
                <rect x="44.979" y="110.47" width="3.9688" height="47.625" fill="#aaa" />
            </symbol>
        </defs>
        <!-- <use transform="translate(3.9687)" width="100%" height="100%" xlink:href="#symbol9718" /> -->
        <path d="m34.396 102.53v55.562h125.68" fill="none" stroke="#000" stroke-width=".26458px" />
    </svg>

    <!-- Pie Chart -->
    <svg height="200" width="200" viewBox="0 0 200 200">
        <circle r="100" cx="100" cy="100" fill="#ddd" />
        <circle id="pie" r="50" cx="100" cy="100" fill="transparent" stroke="#0074d9" stroke-width="100"
            stroke-dasharray="calc(10 * 314 / 100) 314" transform="rotate(-90) translate(-200)" />
    </svg>

    <div id="table"></div>

    <script>
        // Gauge
        var label = document.querySelector("#label");
        var pointer = document.querySelector("#pointer");

        var pointerC = pointer.getBBox();
        var pointerXOrigin = pointerC.x + pointerC.width - 2.5;
        var pointerYOrigin = pointerC.y + 2.5;

        setInterval(() => {
            var percentage = Math.round(Math.random() * 100);

            pointer.style.transform = "rotate(" + (percentage * 2.7) + "deg)";
            pointer.style.transition = "transform 1s ease-in-out";
            // pointer.style.transformOrigin = "center";
            pointer.style.transformOrigin = pointerXOrigin + "px " + pointerYOrigin + "px";

            label.textContent = percentage + "%";
        }, 2000)

        // Bar Chart
        var main = document.querySelector("#main");

        for (let i = 0; i < 10; i++) {
            var useElem = document.createElementNS('http://www.w3.org/2000/svg', 'use');

            useElem.setAttributeNS('http://www.w3.org/1999/xlink', 'xlink:href', '#symbol9718');
            useElem.style.x = i * 10;

            main.prepend(useElem);

            var useElemC = useElem.getBBox();
            var useElemXOrigin = useElemC.x + useElemC.width / 2;
            var useElemYOrigin = useElemC.y + useElemC.height;
            useElem.style.transformOrigin = useElemXOrigin + "px " + useElemYOrigin + "px";
            useElem.style.transition = "transform 1s ease";

            setInterval(() => {
                var percentage = Math.random();
                useElem.style.transform = "scaleY(" + percentage + ")";
            }, 2000)
        }

        // Pie Chart
        var pie = document.querySelector("#pie");
        pie.style.transition = "stroke-dasharray 1s ease";

        setInterval(() => {
            var percentage = Math.round(Math.random() * 100);
            pie.style.strokeDasharray = "calc(" + percentage + " * 314 / 100) 314";
        }, 2000)

        fetch("http://localhost:3000/weather")
            .then(x => x.json())
            .then(x => {
               
                $("div").dxButton();
                
                console.log(window)
                console.log(x)
            })
    </script>
</body>

</html>